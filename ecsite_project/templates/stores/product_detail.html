{% extends 'base.html' %}

{% block content %}
<div class="col-6 offset-3">
    <div style="float: left; padding: 0 20px 20px 0">
        {% for picture in object.productpictures_set.all %}
            {% if forloop.first %}
                <div><img width="200px" height="200px" src="{{ picture.picture.url }}"></div>
            {% else %}
                <img width="50px" height="50px" src="{{ picture.picture.url }}">
            {% endif %}
        {% endfor %}
    </div>
    <div>
        <p>Product Name: {{ object.name }}</p>
        <p>Product Price: {{ object.price }}</p>
        <p>Product Stock: {{ object.stock }}</p>
        {% if object.stock %}
            <input type="number" id="quantity" name="Quantity" min="1" max="{{ object.stock }}"><br>
            <button id="add_product" type="button" class="btn btn-primary">Add cart</button>
        {% endif %}
        <input type="text" name="csrfToken" value="{{ csrf_token }}" type="hidden">
    </div>
</div>
<script>
    $('#add_product').click(function(){
        var quantity = $("#quantity").val();
        $.ajax({
            url: "{% url 'stores:add_product' %}",
            type: "POST",
            data: {product_id: "{{ object.id }}", quantity: quantity},
            datatype: "json",
            success: function(json){
                if(json.message){
                    alert(json.message);
                }
            },
            error: function(error){
                alert(error.responseJSON.message);
            }
        });
    });
</script>

{% endblock content %}